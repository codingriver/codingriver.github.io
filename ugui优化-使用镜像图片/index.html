<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>【Unity优化】：使用镜像图片 - codingriver blog</title><meta name="Description" content="codingriver blog"><meta property="og:title" content="【Unity优化】：使用镜像图片" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" /><meta property="og:image" content="https://codingriver.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-01T21:57:40+08:00" />
<meta property="article:modified_time" content="2019-12-01T21:57:40+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://codingriver.github.io/logo.png"/>

<meta name="twitter:title" content="【Unity优化】：使用镜像图片"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="codingriver">
<meta name="apple-mobile-web-app-title" content="codingriver"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" /><link rel="prev" href="https://codingriver.github.io/unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%89%A9%E5%B1%95%E8%8F%9C%E5%8D%95%E9%A1%B9/" /><link rel="next" href="https://codingriver.github.io/unity%E4%BC%98%E5%8C%96-%E7%9B%B8%E5%90%8C%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B%E8%AE%BE%E7%BD%AE%E5%90%84%E8%87%AA%E7%9A%84%E9%A2%9C%E8%89%B2%E4%BC%98%E5%8C%96/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "【Unity优化】：使用镜像图片",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/codingriver.github.io\/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87\/"
        },"genre": "posts","keywords": "UGUI, unity优化","wordcount":  3860 ,
        "url": "https:\/\/codingriver.github.io\/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87\/","datePublished": "2019-12-01T21:57:40+08:00","dateModified": "2019-12-01T21:57:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx"},"author": {
                "@type": "Person",
                "name": "codingriver"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="codingriver blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>codingriver</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/codingriver" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="codingriver blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>codingriver</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/codingriver" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">【Unity优化】：使用镜像图片</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://codingriver.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>codingriver</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/ugui%E4%BC%98%E5%8C%96/"><i class="far fa-folder fa-fw"></i>UGUI优化</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2019-12-01 21:57:40">2019-12-01 21:57:40</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3860 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;<span id="/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" class="leancloud_visitors" data-flag-title="【Unity优化】：使用镜像图片">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#0x01-simple类型">0X01 Simple类型</a></li>
            <li><a href="#0x02-sliced类型">0X02 Sliced类型</a></li>
            <li><a href="#0x03-tiled类型">0X03 Tiled类型</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><blockquote>
<p>ui中使用好多像按钮等对称的图片，如果使用1/2、1/4图片将大量的节省内存，这里详细说下这个解决方案；</p>
</blockquote>
<p>unity版本：2018.2.13f1
ugui源码版本2018.2（这里在这个版本基础上修改的）</p>
<p>使用的素材有1/2、1/4图片
<strong>下面1/2图片</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202506494.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202506494.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202506494.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202506494.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202506494.png"
        title="在这里插入图片描述" /></p>
<p><strong>左边1/2图片</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202538148.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202538148.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202538148.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202538148.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202538148.png"
        title="在这里插入图片描述" /></p>
<p><strong>左下1/4图片</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202555451.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202555451.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202555451.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202555451.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211202555451.png"
        title="在这里插入图片描述" /></p>
<p><strong>这里新建类<code>MirrorImage</code>继承Image，对Image功能进行扩展</strong>
根据ImageType 分为四种扩展：Simple，Sliced，Tiled，Filled；只处理了三种</p>
<h4 id="0x01-simple类型">0X01 Simple类型</h4>
<p>1.先在MirrorImage中增加变量<code>mirrorType</code>来定义当前原始素材是是要用什么镜像类型</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// 镜像类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">public</span> <span class="k">enum</span> <span class="n">MirrorType</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 水平
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 提供左侧一半素材
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Horizontal</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 垂直
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 提供下侧一半素材
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Vertical</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 四分之一
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 相当于水平，然后再垂直
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// 提供左下侧素材
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Quarter</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// 镜像类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">private</span> <span class="n">MirrorType</span> <span class="n">_mirrorType</span> <span class="o">=</span> <span class="n">MirrorType</span><span class="p">.</span><span class="n">Horizontal</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">MirrorType</span> <span class="n">mirrorType</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_mirrorType</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">set</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">_mirrorType</span> <span class="o">!=</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_mirrorType</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">SetVerticesDirty</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121210365169.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121210365169.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121210365169.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121210365169.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121210365169.png"
        title="在这里插入图片描述" /></p>
<p>这个地方需要修改editor，下面有整个工程，可以看下
2.重写<code>SetNativeSize</code>方法，实现自动扩展MirrorImage镜像的大小,根据素材的大小和镜像类型来自动配置image大小</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">override</span> <span class="kt">void</span> <span class="nf">SetNativeSize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">sprite</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">float</span> <span class="n">w</span> <span class="o">=</span> <span class="n">sprite</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">float</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sprite</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">mirrorType</span><span class="o">==</span> <span class="n">MirrorType</span><span class="p">.</span><span class="n">Horizontal</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">w</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">mirrorType</span> <span class="o">==</span> <span class="n">MirrorType</span><span class="p">.</span><span class="n">Vertical</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">w</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">rectTransform</span><span class="p">.</span><span class="n">anchorMax</span> <span class="o">=</span> <span class="n">rectTransform</span><span class="p">.</span><span class="n">anchorMin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">rectTransform</span><span class="p">.</span><span class="n">sizeDelta</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">SetAllDirty</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>3 重写OnPopulateMesh方法，这个方法会修改mesh信息，然后给Graphic</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">protected</span> <span class="n">override</span> <span class="kt">void</span> <span class="nf">OnPopulateMesh</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">toFill</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sprite</span> <span class="n">_sprite</span> <span class="o">=</span> <span class="n">overrideSprite</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">?</span> <span class="nl">overrideSprite</span> <span class="p">:</span> <span class="n">sprite</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_sprite</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">base</span><span class="p">.</span><span class="n">OnPopulateMesh</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Simple</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateSimpleSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="n">preserveAspect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Sliced</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateSlicedSprite(toFill);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Tiled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateTiledSprite(toFill);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Filled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateFilledSprite(toFill, m_PreserveAspect);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里先处理Simple类型
4. 修改Mesh信息和uv信息，在Image原来的基础上，将mesh增加两个顶点（1/2图片），如果是Horizontal镜像类型，将右侧两个定点移动到中间，在右侧增加这两个定点，uv信息要和左侧的对称</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// Generate vertices for a simple Image.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">void</span> <span class="nf">GenerateSimpleSprite</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">vh</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">lPreserveAspect</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Vector4</span> <span class="n">v</span> <span class="o">=</span> <span class="n">GetDrawingDimensions</span><span class="p">(</span><span class="n">lPreserveAspect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">var</span> <span class="n">uv</span> <span class="o">=</span> <span class="p">(</span><span class="n">sprite</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="o">?</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetOuterUV</span><span class="p">(</span><span class="n">sprite</span><span class="p">)</span> <span class="o">:</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Vector4</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log(&#34;uv::::&#34; + uv + &#34;  v:&#34; + v+ &#34;  center:&#34;+ rectTransform.rect.center+ &#34;  rect:&#34; + rectTransform.rect);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">mirrorType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Horizontal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Vertical</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Quarter</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//v.w = (v.w + v.y) / 2;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//Debug.Log(&#34;uv::::&#34; + uv + &#34;  v:&#34; + v + &#34;  center:&#34; + rectTransform.rect.center + &#34;  rect:&#34; + rectTransform.rect);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">var</span> <span class="n">color32</span> <span class="o">=</span> <span class="n">color</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">mirrorType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">/// 1,2,5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">/// 0,3,4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Horizontal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//4,5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//1,2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//0,3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Vertical</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">/// 8,7,6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">/// 1,2,5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">/// 0,3,4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Quarter</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">y</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddVert</span><span class="p">(</span><span class="n">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">v1</span><span class="p">.</span><span class="n">w</span><span class="p">),</span> <span class="n">color32</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">vh</span><span class="p">.</span><span class="n">AddTriangle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>水平镜像后：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210600513.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210600513.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210600513.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210600513.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210600513.png"
        title="在这里插入图片描述" /></p>
<h4 id="0x02-sliced类型">0X02 Sliced类型</h4>
<p>修改上面的步骤
3 重写OnPopulateMesh方法，这个方法会修改mesh信息，然后给Graphic；增加Sliced类型</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">protected</span> <span class="n">override</span> <span class="kt">void</span> <span class="nf">OnPopulateMesh</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">toFill</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sprite</span> <span class="n">_sprite</span> <span class="o">=</span> <span class="n">overrideSprite</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">?</span> <span class="nl">overrideSprite</span> <span class="p">:</span> <span class="n">sprite</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_sprite</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">base</span><span class="p">.</span><span class="n">OnPopulateMesh</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Simple</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateSimpleSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="n">preserveAspect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Sliced</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateSlicedSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Tiled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateTiledSprite(toFill);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Filled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateFilledSprite(toFill, m_PreserveAspect);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.Sliced类型支持九宫图，这里注意九宫图做的时候，水平镜像要注意保留九宫图中间无限拉伸的那部分，456区域会镜像并且和原始456区域组成九宫图中心部分进行拉伸，这里注意右侧border不要拉出来。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210110143.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210110143.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210110143.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210110143.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210110143.png"
        title="在这里插入图片描述" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="n">private</span> <span class="kt">void</span> <span class="nf">GenerateSlicedSprite</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">toFill</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">GenerateSimpleSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Vector4</span> <span class="n">outer</span><span class="p">,</span> <span class="n">inner</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">border</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">sprite</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">outer</span> <span class="o">=</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetOuterUV</span><span class="p">(</span><span class="n">sprite</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">inner</span> <span class="o">=</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetInnerUV</span><span class="p">(</span><span class="n">sprite</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span> <span class="o">=</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetPadding</span><span class="p">(</span><span class="n">sprite</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">border</span> <span class="o">=</span> <span class="n">sprite</span><span class="p">.</span><span class="n">border</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">outer</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">inner</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">border</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Rect</span> <span class="n">rect</span> <span class="o">=</span> <span class="n">GetPixelAdjustedRect</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Vector4</span> <span class="n">adjustedBorders</span> <span class="o">=</span> <span class="n">GetAdjustedBorders</span><span class="p">(</span><span class="n">border</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">,</span> <span class="n">rect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log($&#34;outer:{outer},inner:{inner},padding:{padding},adjustedBorders:{adjustedBorders},border:{border}&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log($&#34;outer:{outer},inner:{inner},padding:{padding},border:{border}&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">padding</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">padding</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">padding</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">adjustedBorders</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">adjustedBorders</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">adjustedBorders</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">adjustedBorders</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log($&#34;vert1:{s_VertScratch[0]},{s_VertScratch[1]},{s_VertScratch[2]},{s_VertScratch[3]},&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//Debug.Log($&#34;uv1:{s_UVScratch[0]},{s_UVScratch[1]},{s_UVScratch[2]},{s_UVScratch[3]},&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">switch</span> <span class="p">(</span><span class="n">mirrorType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Horizontal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="o">-</span><span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="o">-</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Vertical</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Quarter</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">s_UVScratch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log($&#34;uv2:{s_UVScratch[0]},{s_UVScratch[1]},{s_UVScratch[2]},{s_UVScratch[3]},&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//Debug.Log($&#34;vert2:{s_VertScratch[0]},{s_VertScratch[1]},{s_VertScratch[2]},{s_VertScratch[3]},&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">s_VertScratch</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">+=</span> <span class="n">rect</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">s_VertScratch</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">+=</span> <span class="n">rect</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">toFill</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fillCenter</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">s_VertScratch</span><span class="p">[</span><span class="n">x2</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s_VertScratch</span><span class="p">[</span><span class="n">y2</span><span class="p">].</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">s_UVScratch</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s_UVScratch</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">s_UVScratch</span><span class="p">[</span><span class="n">x2</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">s_UVScratch</span><span class="p">[</span><span class="n">y2</span><span class="p">].</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>镜像后的效果：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210349466.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210349466.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210349466.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210349466.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211210349466.png"
        title="在这里插入图片描述" /></p>
<h4 id="0x03-tiled类型">0X03 Tiled类型</h4>
<p>修改上面的步骤
3 重写OnPopulateMesh方法，这个方法会修改mesh信息，然后给Graphic；增加Tiled类型</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">protected</span> <span class="n">override</span> <span class="kt">void</span> <span class="nf">OnPopulateMesh</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">toFill</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sprite</span> <span class="n">_sprite</span> <span class="o">=</span> <span class="n">overrideSprite</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">?</span> <span class="nl">overrideSprite</span> <span class="p">:</span> <span class="n">sprite</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_sprite</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">base</span><span class="p">.</span><span class="n">OnPopulateMesh</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">type</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Simple</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateSimpleSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="n">preserveAspect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Sliced</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateSlicedSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Tiled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">GenerateTiledSprite</span><span class="p">(</span><span class="n">toFill</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">Type</span><span class="p">.</span><span class="nl">Filled</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//GenerateFilledSprite(toFill, m_PreserveAspect);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>4.Tiled类型这里注意，不支持九宫图，注意不要曾加border；
假设是水平镜像类型：tiled平铺时会自动把右侧相邻的镜像补上
<strong>没有九宫的border线，一定要注意，要不然出错</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121121110096.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121121110096.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121121110096.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121121110096.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/2018121121110096.png"
        title="在这里插入图片描述" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="c1">/// &lt;summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// Generate vertices for a tiled Image.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">/// &lt;/summary&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">GenerateTiledSprite</span><span class="p">(</span><span class="n">VertexHelper</span> <span class="n">toFill</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Debug.Log(&#34;==============================&amp;&amp;&amp;&amp;&amp;&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Vector4</span> <span class="n">outer</span><span class="p">,</span> <span class="n">inner</span><span class="p">,</span> <span class="n">border</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Vector2</span> <span class="n">spriteSize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">sprite</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">outer</span> <span class="o">=</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetOuterUV</span><span class="p">(</span><span class="n">sprite</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">inner</span> <span class="o">=</span> <span class="n">DataUtility</span><span class="p">.</span><span class="n">GetInnerUV</span><span class="p">(</span><span class="n">sprite</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">border</span> <span class="o">=</span> <span class="n">sprite</span><span class="p">.</span><span class="n">border</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">spriteSize</span> <span class="o">=</span> <span class="n">sprite</span><span class="p">.</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">outer</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">inner</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">border</span> <span class="o">=</span> <span class="n">Vector4</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">spriteSize</span> <span class="o">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">one</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Rect</span> <span class="n">rect</span> <span class="o">=</span> <span class="n">GetPixelAdjustedRect</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">tileWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">spriteSize</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">tileHeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">spriteSize</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">border</span> <span class="o">=</span> <span class="n">GetAdjustedBorders</span><span class="p">(</span><span class="n">border</span> <span class="o">/</span> <span class="n">pixelsPerUnit</span><span class="p">,</span> <span class="n">rect</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">var</span> <span class="n">uvMin</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">var</span> <span class="n">uvMax</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">inner</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">inner</span><span class="p">.</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Min to max max range for tiled region in coordinates relative to lower left corner.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">float</span> <span class="n">xMin</span> <span class="o">=</span> <span class="n">border</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">xMax</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">yMin</span> <span class="o">=</span> <span class="n">border</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">yMax</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">border</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">toFill</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">var</span> <span class="n">clipped</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// if either width is zero we cant tile so just assume it was the full width.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">tileWidth</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">tileWidth</span> <span class="o">=</span> <span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">tileHeight</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">tileHeight</span> <span class="o">=</span> <span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">sprite</span> <span class="o">!=</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">hasBorder</span> <span class="o">||</span> <span class="n">sprite</span><span class="p">.</span><span class="n">packed</span> <span class="o">||</span> <span class="n">sprite</span><span class="p">.</span><span class="n">texture</span><span class="p">.</span><span class="n">wrapMode</span> <span class="o">!=</span> <span class="n">TextureWrapMode</span><span class="p">.</span><span class="n">Repeat</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Sprite has border, or is not in repeat mode, or cannot be repeated because of packing.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// We cannot use texture tiling so we will generate a mesh of quads to tile the texture.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Evaluate how many vertices we will generate. Limit this number to something sane,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// especially since meshes can not have more than 65000 vertices.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="kt">long</span> <span class="n">nTilesW</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">long</span> <span class="n">nTilesH</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">fillCenter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">nTilesW</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Ceil</span><span class="p">((</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileWidth</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">nTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Ceil</span><span class="p">((</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileHeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="kt">double</span> <span class="n">nVertices</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">nVertices</span> <span class="o">=</span> <span class="p">(</span><span class="n">nTilesW</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nTilesH</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">;</span> <span class="c1">// 4 vertices per tile
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">nVertices</span> <span class="o">=</span> <span class="n">nTilesW</span> <span class="o">*</span> <span class="n">nTilesH</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">;</span> <span class="c1">// 4 vertices per tile
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">nVertices</span> <span class="o">&gt;</span> <span class="mf">65000.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">//Debug.LogError(&#34;Too many sprite tiles on Image \&#34;&#34; + name + &#34;\&#34;. The tile size will be increased. To remove the limit on the number of tiles, convert the Sprite to an Advanced texture, remove the borders, clear the Packing tag and set the Wrap mode to Repeat.&#34;, this);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                    <span class="kt">double</span> <span class="n">maxTiles</span> <span class="o">=</span> <span class="mf">65000.0</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">;</span> <span class="c1">// Max number of vertices is 65000; 4 vertices per tile.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="kt">double</span> <span class="n">imageRatio</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">imageRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">nTilesW</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nTilesH</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">imageRatio</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nTilesW</span> <span class="o">/</span> <span class="n">nTilesH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">targetTilesW</span> <span class="o">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="n">Sqrt</span><span class="p">((</span><span class="kt">float</span><span class="p">)(</span><span class="n">maxTiles</span> <span class="o">/</span> <span class="n">imageRatio</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">targetTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">targetTilesW</span> <span class="o">*</span> <span class="n">imageRatio</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">targetTilesW</span> <span class="o">-=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">targetTilesH</span> <span class="o">-=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">nTilesW</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Floor</span><span class="p">(</span><span class="n">targetTilesW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">nTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Floor</span><span class="p">(</span><span class="n">targetTilesH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tileWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nTilesW</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tileHeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nTilesH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// Texture on the border is repeated only in one direction.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">nTilesW</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Ceil</span><span class="p">((</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileWidth</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">nTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Ceil</span><span class="p">((</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileHeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">double</span> <span class="n">nVertices</span> <span class="o">=</span> <span class="p">(</span><span class="n">nTilesH</span> <span class="o">+</span> <span class="n">nTilesW</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="cm">/*corners*/</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="cm">/*sides*/</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="cm">/*vertices per tile*/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">nVertices</span> <span class="o">&gt;</span> <span class="mf">65000.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="c1">//Debug.LogError(&#34;Too many sprite tiles on Image \&#34;&#34; + name + &#34;\&#34;. The tile size will be increased. To remove the limit on the number of tiles, convert the Sprite to an Advanced texture, remove the borders, clear the Packing tag and set the Wrap mode to Repeat.&#34;, this);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                        <span class="kt">double</span> <span class="n">maxTiles</span> <span class="o">=</span> <span class="mf">65000.0</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">;</span> <span class="c1">// Max number of vertices is 65000; 4 vertices per tile.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                        <span class="kt">double</span> <span class="n">imageRatio</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nTilesW</span> <span class="o">/</span> <span class="n">nTilesH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="kt">float</span> <span class="n">targetTilesW</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)((</span><span class="n">maxTiles</span> <span class="o">-</span> <span class="mi">4</span> <span class="cm">/*corners*/</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">imageRatio</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">                        <span class="kt">float</span> <span class="n">targetTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">targetTilesW</span> <span class="o">*</span> <span class="n">imageRatio</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="n">nTilesW</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Floor</span><span class="p">(</span><span class="n">targetTilesW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">nTilesH</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">Mathf</span><span class="p">.</span><span class="n">Floor</span><span class="p">(</span><span class="n">targetTilesH</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">tileWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nTilesW</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">tileHeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nTilesH</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">nTilesH</span> <span class="o">=</span> <span class="n">nTilesW</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">fillCenter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// TODO: we could share vertices between quads. If vertex sharing is implemented. update the computation for the number of vertices accordingly.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">for</span> <span class="p">(</span><span class="kt">long</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nTilesH</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">yMin</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">tileHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">yMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tileHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">y2e</span> <span class="o">=</span> <span class="n">y2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">y2</span> <span class="o">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">clipped</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">y2</span> <span class="o">=</span> <span class="n">yMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">clipped</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">for</span> <span class="p">(</span><span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nTilesW</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="kt">float</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tileWidth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="kt">float</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tileWidth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="kt">float</span> <span class="n">x2e</span><span class="o">=</span><span class="n">x2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="p">(</span><span class="n">x2</span> <span class="o">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">clipped</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="n">x2</span> <span class="o">=</span> <span class="n">xMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="n">var</span> <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">var</span> <span class="n">clipped1</span> <span class="o">=</span> <span class="n">clipped</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="c1">//Debug.Log(&#34;i::&#34; + i + &#34;  j:::&#34; + j);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                        <span class="k">switch</span> <span class="p">(</span><span class="n">mirrorType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Horizontal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetX</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">-</span> <span class="n">x1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//clipped1 = new Vector2(uvMin.x, clipped.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">clipped1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">offsetX</span><span class="p">,</span> <span class="n">clipped</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Vertical</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetY</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">-</span> <span class="n">y1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//uvMin1 = new Vector2(uvMin.x, clipped.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//clipped1 = new Vector2(clipped.x, uvMin.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">clipped1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">clipped</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">offsetY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                            <span class="k">case</span> <span class="n">MirrorType</span><span class="p">.</span><span class="nl">Quarter</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                <span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetX</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetX</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">-</span> <span class="n">x1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetY</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetY</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">-</span> <span class="n">y1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                    <span class="n">clipped1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">offsetX</span><span class="p">,</span><span class="n">offsetY</span><span class="p">)</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetY</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y2e</span> <span class="o">-</span> <span class="n">y1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//uvMin1 = new Vector2(uvMin.x, clipped.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//clipped1 = new Vector2(clipped.x, uvMin.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">clipped1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">clipped</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">offsetY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                    <span class="kt">float</span> <span class="n">offsetX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                                    <span class="k">if</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">offsetX</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2e</span> <span class="o">-</span> <span class="n">x1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">uvMin1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                    <span class="c1">//clipped1 = new Vector2(uvMin.x, clipped.y);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                                    <span class="n">clipped1</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">offsetX</span><span class="p">,</span> <span class="n">clipped</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        
</span></span><span class="line"><span class="cl">                        <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">uvMin1</span><span class="p">,</span> <span class="n">clipped1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">hasBorder</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">clipped</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="p">(</span><span class="kt">long</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nTilesH</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">yMin</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">tileHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">yMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tileHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">y2</span> <span class="o">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">clipped</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">y2</span> <span class="o">=</span> <span class="n">yMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">clipped</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                    <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMax</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">clipped</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// Bottom and top tiled border
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">clipped</span> <span class="o">=</span> <span class="n">uvMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="p">(</span><span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nTilesW</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">tileWidth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">float</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">tileWidth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">x2</span> <span class="o">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">clipped</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">x2</span> <span class="o">=</span> <span class="n">xMax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">clipped</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                    <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">yMax</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">clipped</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// Corners
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMax</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">uvMin</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">yMax</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMin</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">color</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">uvMax</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uvMax</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">outer</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">outer</span><span class="p">.</span><span class="n">w</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Texture has no border, is in repeat mode and not packed. Use texture tiling.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Vector2</span> <span class="n">uvScale</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">((</span><span class="n">xMax</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileWidth</span><span class="p">,</span> <span class="p">(</span><span class="n">yMax</span> <span class="o">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">tileHeight</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">fillCenter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">AddQuad</span><span class="p">(</span><span class="n">toFill</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">yMin</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">xMax</span><span class="p">,</span> <span class="n">yMax</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">uvMin</span><span class="p">,</span> <span class="n">uvScale</span><span class="p">),</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">uvMax</span><span class="p">,</span> <span class="n">uvScale</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>镜像后：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211241904.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211241904.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211241904.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211241904.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211241904.png"
        title="在这里插入图片描述" /></p>
<p>如果是左下1/4图片</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211319238.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211319238.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211319238.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211319238.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211319238.png"
        title="在这里插入图片描述" /></p>
<p>则4个tile组成一个完整的图</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211407233.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211407233.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211407233.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211407233.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211407233.png"
        title="在这里插入图片描述" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211509926.png"
        data-srcset="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211509926.png, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211509926.png 1.5x, https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211509926.png 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/codingriver/cdn/20181211211509926.png"
        title="在这里插入图片描述" /></p>
<p><a href="https://github.com/codingriver/UnityProjectTest/tree/master/MirrorImage" target="_blank" rel="noopener noreffer">github工程</a></p>
<blockquote>
<p>参考文章
<a href="https://zhuanlan.zhihu.com/p/25995971" target="_blank" rel="noopener noreffer">https://zhuanlan.zhihu.com/p/25995971</a></p>
</blockquote></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2019-12-01 21:57:40</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-hashtag="UGUI"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片" data-ralateuid="xxxx"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片" data-description=""><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/myspace.svg"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://codingriver.github.io/ugui%E4%BC%98%E5%8C%96-%E4%BD%BF%E7%94%A8%E9%95%9C%E5%83%8F%E5%9B%BE%E7%89%87/" data-title="【Unity优化】：使用镜像图片"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/ugui/">UGUI</a>,&nbsp;<a href="/tags/unity%E4%BC%98%E5%8C%96/">unity优化</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%89%A9%E5%B1%95%E8%8F%9C%E5%8D%95%E9%A1%B9/" class="prev" rel="prev" title="【Unity编辑器】 扩展菜单项及右键菜单"><i class="fas fa-angle-left fa-fw"></i>【Unity编辑器】 扩展菜单项及右键菜单</a>
            <a href="/unity%E4%BC%98%E5%8C%96-%E7%9B%B8%E5%90%8C%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B%E8%AE%BE%E7%BD%AE%E5%90%84%E8%87%AA%E7%9A%84%E9%A2%9C%E8%89%B2%E4%BC%98%E5%8C%96/" class="next" rel="next" title="【unity优化】相同模型的多个实例设置各自的颜色优化">【unity优化】相同模型的多个实例设置各自的颜色优化<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.94.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">codingriver</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"TU9HHvqYbHWiqJGgbDQXTTHy-gzGzoHsz","appKey":"dN7hDY1PObmpH2SGFBNkIv88","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"説点啥吧...","recordIP":true,"serverURLs":"https://tu9hhvqy.lc-cn-n1-shared.com","visitor":true}},"search":{"algoliaAppID":"KLY81C70FD","algoliaIndex":"index","algoliaSearchKey":"f07750bedf42546c5e3339e308d17b97","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
